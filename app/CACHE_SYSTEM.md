# ุณุณุชู ฺฉุด (Cache System)

## ุชูุถุญุงุช ฺฉู

ุงู ุณุณุชู ฺฉุด ุจุฑุง ุจูููโุณุงุฒ ุฏุฑุฎูุงุณุชโูุง API ู ฺฉุงูุด ุจุงุฑ ุณุฑูุฑ ุทุฑุงุญ ุดุฏู ุงุณุช. ุฏุงุฏูโูุง ุจู ูุฏุช **30 ุฏููู** ุฏุฑ ุญุงูุธู ฺฉุด ูโุดููุฏ.

## ูุญูู ฺฉุงุฑฺฉุฑุฏ

### 1. ุงููู ุฏุฑุฎูุงุณุช
- ฺฉุงุฑุจุฑ ุตูุญู ุดูุงุฑู ูุฌุงุฒ ุฑุง ุจุงุฒ ูโฺฉูุฏ
- ุฏุฑุฎูุงุณุช ุจู `/api/prices/1` ุงุฑุณุงู ูโุดูุฏ
- ฺฉุด ุฎุงู ุงุณุชุ ุจูุงุจุฑุงู ุฏุฑุฎูุงุณุช ุจู API ุฎุงุฑุฌ ุงุฑุณุงู ูโุดูุฏ
- ูพุงุณุฎ ูพุฑุฏุงุฒุด ู ุฏุฑ ฺฉุด ุฐุฎุฑู ูโุดูุฏ
- ุฏุงุฏูโูุง ุจู ฺฉุงุฑุจุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ

### 2. ุฏุฑุฎูุงุณุชโูุง ุจุนุฏ (ุฏุฑ 30 ุฏููู)
- ฺฉุงุฑุจุฑ ุตูุญู ุฑุง ุฏูุจุงุฑู ุจุงุฒ ูโฺฉูุฏ
- ุฏุฑุฎูุงุณุช ุจู `/api/prices/1` ุงุฑุณุงู ูโุดูุฏ
- ฺฉุด ุจุฑุฑุณ ูโุดูุฏ ู ุฏุงุฏู ููุฌูุฏ ุงุณุช
- ุฏุงุฏู ุงุฒ ฺฉุด ุจุฑฺฏุฑุฏุงูุฏู ูโุดูุฏ (ุจุฏูู ุฏุฑุฎูุงุณุช ุจู API ุฎุงุฑุฌ)
- ุณุฑุนุช ุจุงุฑฺฏุฐุงุฑ ุจุณุงุฑ ุณุฑุนโุชุฑ ุงุณุช

### 3. ูพุณ ุงุฒ 30 ุฏููู
- ฺฉุด ูููุถ ูโุดูุฏ
- ุฏุฑุฎูุงุณุช ุจุนุฏ ุฏูุจุงุฑู ุจู API ุฎุงุฑุฌ ุงุฑุณุงู ูโุดูุฏ
- ุฏุงุฏู ุฌุฏุฏ ุฏุฑ ฺฉุด ุฐุฎุฑู ูโุดูุฏ

## ูุงูโูุง ูุฑุจูุทู

### 1. `CacheService.ts`
- ุณุฑูุณ ุงุตู ฺฉุด
- ูุฏุฑุช ุฐุฎุฑู ู ุจุงุฒุงุจ ุฏุงุฏูโูุง
- ุจุฑุฑุณ ุงููุถุง ฺฉุด

### 2. `api/prices/[serviceId]/route.ts`
- API endpoint ุจุฑุง ุฏุฑุงูุช ููุชโูุง
- ุจุฑุฑุณ ฺฉุด ูุจู ุงุฒ ุฏุฑุฎูุงุณุช ุจู API ุฎุงุฑุฌ
- ุฐุฎุฑู ูพุงุณุฎ ุฏุฑ ฺฉุด

### 3. `useVirtualNumbers.ts`
- Hook ุจุฑุง ุฏุฑุงูุช ุฏุงุฏูโูุง ุดูุงุฑู ูุฌุงุฒ
- ููุงุด ูพุงูโูุง ฺฉุด ุฏุฑ ฺฉูุณูู

### 4. `CacheDebug.tsx`
- ฺฉุงููพูููุช debug ุจุฑุง ูุฏุฑุช ฺฉุด
- ููุท ุฏุฑ ูุญุท development ููุงุด ุฏุงุฏู ูโุดูุฏ

### 5. `api/cache/clear/route.ts`
- API ุจุฑุง ูพุงฺฉ ฺฉุฑุฏู ฺฉุด
- ูุฏุฑุช ฺฉุด ุงุฒ ุทุฑู API

## ูฺฺฏโูุง

### โ ูุฒุงุง
- **ฺฉุงูุด ุจุงุฑ ุณุฑูุฑ**: ุฏุฑุฎูุงุณุชโูุง ฺฉูุชุฑ ุจู API ุฎุงุฑุฌ
- **ุณุฑุนุช ุจุงูุง**: ุจุงุฑฺฏุฐุงุฑ ุณุฑุนโุชุฑ ุตูุญุงุช
- **ุตุฑููโุฌู ุฏุฑ ูพููุง ุจุงูุฏ**: ฺฉุงูุด ุชุฑุงูฺฉ ุดุจฺฉู
- **ุชุฌุฑุจู ฺฉุงุฑุจุฑ ุจูุชุฑ**: ฺฉุงูุด ุฒูุงู ุงูุชุธุงุฑ

### โ๏ธ ุชูุธูุงุช
- **TTL**: 30 ุฏููู (ูุงุจู ุชุบุฑ)
- **ุฐุฎุฑูโุณุงุฒ**: ุฏุฑ ุญุงูุธู (Memory)
- **ฺฉูุฏ ฺฉุด**: `prices_{serviceId}`

## ูุญูู ุงุณุชูุงุฏู

### ุจุฑุฑุณ ูุถุนุช ฺฉุด
```javascript
// ุฏุฑ ฺฉูุณูู ูุฑูุฑฺฏุฑ
fetch('/api/cache/clear?key=prices_1')
  .then(res => res.json())
  .then(data => console.log(data));
```

### ูพุงฺฉ ฺฉุฑุฏู ฺฉุด
```javascript
// ูพุงฺฉ ฺฉุฑุฏู ฺฉุด ุฎุงุต
fetch('/api/cache/clear?key=prices_1', { method: 'POST' })
  .then(res => res.json())
  .then(data => console.log(data));

// ูพุงฺฉ ฺฉุฑุฏู ุชูุงู ฺฉุด
fetch('/api/cache/clear', { method: 'POST' })
  .then(res => res.json())
  .then(data => console.log(data));
```

## ูุงฺฏโูุง

### ุฏุฑ ฺฉูุณูู ุณุฑูุฑ
- `๐ฆ Cache hit for service 1` - ุฏุงุฏู ุงุฒ ฺฉุด ุฏุฑุงูุช ุดุฏ
- `๐ Cache miss for service 1, fetching from API...` - ุฏุงุฏู ุงุฒ API ุฏุฑุงูุช ุดุฏ
- `๐พ Data cached for service 1 for 30 minutes` - ุฏุงุฏู ุฏุฑ ฺฉุด ุฐุฎุฑู ุดุฏ

### ุฏุฑ ฺฉูุณูู ูุฑูุฑฺฏุฑ
- `๐ฆ Data loaded from cache` - ุฏุงุฏู ุงุฒ ฺฉุด ุจุงุฑฺฏุฐุงุฑ ุดุฏ
- `๐ Data loaded from API` - ุฏุงุฏู ุงุฒ API ุจุงุฑฺฏุฐุงุฑ ุดุฏ

## ูฺฉุงุช ููู

1. **ฺฉุด ุฏุฑ ุญุงูุธู**: ุจุง restart ุณุฑูุฑุ ฺฉุด ูพุงฺฉ ูโุดูุฏ
2. **TTL ูุงุจู ุชูุธู**: ูโุชูุงู ุฒูุงู ุงููุถุง ุฑุง ุชุบุฑ ุฏุงุฏ
3. **Debug mode**: ฺฉุงููพูููุช debug ููุท ุฏุฑ development ููุงุด ุฏุงุฏู ูโุดูุฏ
4. **Error handling**: ุฏุฑ ุตูุฑุช ุฎุทุงุ ุฏุงุฏูโูุง ูพุดโูุฑุถ ููุงุด ุฏุงุฏู ูโุดูุฏ

## ุชุบุฑ TTL

ุจุฑุง ุชุบุฑ ุฒูุงู ุงููุถุง ฺฉุดุ ุฏุฑ ูุงู `api/prices/[serviceId]/route.ts` ุฎุท ุฒุฑ ุฑุง ุชุบุฑ ุฏูุฏ:

```typescript
// ุฐุฎุฑู ุฏุฑ ฺฉุด ุจุฑุง 30 ุฏููู
cacheService.set(cacheKey, processedData, 30); // 30 = 30 ุฏููู
```

## ูพุงฺฉ ฺฉุฑุฏู ฺฉุด ุฏุฑ production

ุจุฑุง ูพุงฺฉ ฺฉุฑุฏู ฺฉุด ุฏุฑ productionุ ุงุฒ API endpoint ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
curl -X POST "https://yourdomain.com/api/cache/clear?key=prices_1"
```
